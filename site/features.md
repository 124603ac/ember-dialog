---
layout: main
title:  "Features"
date:   2014-12-24 12:25:40
categories: jekyll update
---
## Описание

Библиотека состоит из 3 частей:

- Менеджер диалоговых окон
- Компонент окна
- Инициализатор, который добавляет менеджера куда надо ;)

### Менеждер диалоговых окон

Менеджер является фасадной частью библиотеки. Его зона ответственности заключается в:

- создании новых окон с нужными опциями и названием
- прикреплении/откреплении контроллера к компоненту окна, для прокидывания событий
- создании нехватающих сущностей для окна (таких как `controller` или `view`)
- контролирует порядок показа и активность мадальных окон (чтобы нужные события попадали только в компонент активного окна)

### Компонент окна

Является конечной точкой получения всех событий, связанных с окном. Таких как нажатия клавиш `enter` и `esc`, клик по кнопкам "YES" и "NO".

### Инициализатор

Создает экземпляр класса `менеджера` и инжектит его всем контроллерам, чтобы можно было дотянуться до него через свойство `dialogManager`.

## Принцип работы & особенности

Основная особенность данной библиотеки состоит в том, что при создании нового окна, ему назначается контроллер, который используется для:

- рендеринга шаблона
- прослушивания событий

На время существования диалогового окна `target` контроллера подменяется экземпляром компонента окна. Все это делает `менеджер`, который далее следит за актуальностью всех измененных параметров. Таким образом все события которые исходят из шаблона идут через контроллер в экземпляр компонента окна. Данную особенность можно проиллюстрировать примером.

{% highlight javascript %}
// Находясь в контроллере мы может получить менеджера диалоговых
// окон из параметра `dialogManager`.
var manager = this.get('dialogManager');

// Контроллер указывается вторым параметром
var controller = Ember.Controller.createWithMixin({

    // Любые параметры контроллера, который прикрепляется к диалоговому окну
    // можно использовать в шаблоне.
    name: "Milkov Vladimir",

    // Стандартные хендлеры событий виюшек эмбера
    actions: {
        'keyDown': function (e) {
            // События клавиш можно также перехватить в контроллере и они
            // не дойдут до диалогового окна. Таким образом esc и enter клавиши
            // работать перестанут.
            //
            // Можно перехватывать только enter события, например:
            // if (e.keyCode !== 13) return true
        },
        'accept': function (dialog) {
            if (true) {
                // Позволит событию пойти дальше. Событие попадет в компонент
                // модального окна, который его закроет.
                return true;
            } else {
                // Событие не попадет в компонент модального окна,
                // и окно останется открытым. В этом месте возможно
                // вызвать асинхронную операцию, после которой можно закрыть
                // диалоговое окно вручную: dialog.close();
                return false;
            }
        },
    }
});
manager.confirm("Выше имя \{\{name\}\}?", controller);
{% endhighlight %}

